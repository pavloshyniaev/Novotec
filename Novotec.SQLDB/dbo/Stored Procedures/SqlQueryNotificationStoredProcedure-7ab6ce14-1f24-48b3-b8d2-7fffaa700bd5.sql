CREATE PROCEDURE [SqlQueryNotificationStoredProcedure-7ab6ce14-1f24-48b3-b8d2-7fffaa700bd5] AS BEGIN BEGIN TRANSACTION; RECEIVE TOP(0) conversation_handle FROM [SqlQueryNotificationService-7ab6ce14-1f24-48b3-b8d2-7fffaa700bd5]; IF (SELECT COUNT(*) FROM [SqlQueryNotificationService-7ab6ce14-1f24-48b3-b8d2-7fffaa700bd5] WHERE message_type_name = 'http://schemas.microsoft.com/SQL/ServiceBroker/DialogTimer') > 0 BEGIN DROP SERVICE [SqlQueryNotificationService-7ab6ce14-1f24-48b3-b8d2-7fffaa700bd5]; DROP QUEUE [SqlQueryNotificationService-7ab6ce14-1f24-48b3-b8d2-7fffaa700bd5]; DROP PROCEDURE [SqlQueryNotificationStoredProcedure-7ab6ce14-1f24-48b3-b8d2-7fffaa700bd5]; END COMMIT TRANSACTION; END