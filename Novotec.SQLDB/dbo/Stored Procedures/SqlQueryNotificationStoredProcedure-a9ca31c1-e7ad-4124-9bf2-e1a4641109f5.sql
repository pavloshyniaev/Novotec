CREATE PROCEDURE [SqlQueryNotificationStoredProcedure-a9ca31c1-e7ad-4124-9bf2-e1a4641109f5] AS BEGIN BEGIN TRANSACTION; RECEIVE TOP(0) conversation_handle FROM [SqlQueryNotificationService-a9ca31c1-e7ad-4124-9bf2-e1a4641109f5]; IF (SELECT COUNT(*) FROM [SqlQueryNotificationService-a9ca31c1-e7ad-4124-9bf2-e1a4641109f5] WHERE message_type_name = 'http://schemas.microsoft.com/SQL/ServiceBroker/DialogTimer') > 0 BEGIN DROP SERVICE [SqlQueryNotificationService-a9ca31c1-e7ad-4124-9bf2-e1a4641109f5]; DROP QUEUE [SqlQueryNotificationService-a9ca31c1-e7ad-4124-9bf2-e1a4641109f5]; DROP PROCEDURE [SqlQueryNotificationStoredProcedure-a9ca31c1-e7ad-4124-9bf2-e1a4641109f5]; END COMMIT TRANSACTION; END